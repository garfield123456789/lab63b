# การทดลองที่ 3 เรื่อง การเขียนโปรแกรมลงบนไมโครคอนโทรลเลอร์เพื่อนำไปประยุกต์ใช้ในชีวิตประจำวัน

## วัตุประสงค์
1. เพื่อศึกษาการรันโปรแกรมในไมโครคอนโทรเลอร์ไปเชื่อมต่อกับอุปกรณ์อื่นๆ
2. เพื่อนำความรู้ที่ได้จากการทดลองที่ 1-6 มาประยุกต์ออกแบบเพิ่มเติมเพื่อประโยชน์แก่การนำไมโครคอนโทรเลอร์ไปประยุกต์ใช้ในชีวิตประจำวัน

## อุปกรณ์ที่ใช้
1. ไมโครคอนโทรเลอร์(ESP-01)
![Image](https://ae01.alicdn.com/kf/HTB1QMy2J9zqK1RjSZFpq6ykSXXac/ESP8266-ESP-01-ESP01-Serial-WIFI-3-3V-5V-Serial.jpg)
2. สายต่ออุปกรณ์ USB 
3. ซีเรียล
4. Adapter
5. หลอดไฟ LED
6. sensors (DS18B20)
7. คอมพิวเตอร์
![image](https://user-images.githubusercontent.com/80879589/113092556-68336080-9218-11eb-8d98-67c79a6db3a8.png)
8. สายไฟปากนีบ

![image](https://user-images.githubusercontent.com/80879589/113092933-27881700-9219-11eb-9bcf-056075a21a0b.png)


## ศึกษาข้อมูลเบื้องต้น
* https://www.youtube.com/watch?v=ZE4EpLHCdWk&t=375s
* https://www.youtube.com/watch?v=-VKFc2AA5Ag

## วิธีการทำการทดลอง
1. ต่อสาย USB เข้ากับซีเรียล 
2. เสียบ Adapter เข้ากับซีเรียล
3. ต่อ sensors (DS18B20) เข้ากับ Adapter โดยใช้สายปากนีบ
4. เสียบไมโครคอนโทรเลอร์(ESP-01)เข้ากับ Adapter
5. เปิด command prompt เเล้วพิมพ์คำสั่ง **cd lab63b** เพื่อเข้าโปรแกรมตัวอย่าง
6. เลือกโปรแกรมตัวอย่างโดยใช้คำสั่ง **cd lab07**
7. พิมพ์คำสั่ง **vi src/main.cpp** เเล้วกด Enter จะพบข้อมูลต่อไปนี้

```c
#include <Arduino.h>
#include <OneWire.h>
#include <DallasTemperature.h>
#define ONE_WIRE_BUS 2
OneWire oneWire(ONE_WIRE_BUS);
DallasTemperature sensors(&oneWire);

float Celsius = 0;
float Fahrenheit = 0;

void setup() 
{
  sensors.begin();
  Serial.begin(9600);
}

void loop() 
{
  sensors.requestTemperatures();
  Celsius = sensors.getTempCByIndex(0);
  Fahrenheit = sensors.toFahrenheit(Celsius);
  
  Serial.print(Celsius);
  Serial.print(" C  ");
  Serial.print(Fahrenheit);
  Serial.println(" F");

  delay(2000);
  
  if (Celsius>=30){
                Serial.println("==== ON ====");
                digitalWrite(0, HIGH);
	} else (Celsius<30){
		Serial.println("==== OFF ====");
		digitalWrite(0, LOW);
	}
	
}
```
6. อัพโหลดโปรแกรมลงในไมโครคอนโทรนเลอร์ โดยพิมพ์คำสั่ง **pio run -t upload** แล้วกด Enter ในขณะที่รับโปรแกรมใหม่เข้าไปให้กดปุ่มสีดำค้างไว้ แล้วกดปุ่มแดง 1 ครั้ง เพื่อเป็นการ reset คำสั่งเก่า
7. เมื่อทำการลงโปรแกรมเสร็จแล้ว พิมพ์คำสั่ง **pio device monitor** แล้วกด Enter เพื่อดูผลลัพธ์ที่ได้บนหน้าจอคอมพิวเตอร์

## การบันทึกผลการทดลอง
เมื่อนำ sensors (DS18B20) ไปใส่ไว้ในน้ำอุ่นหรือน้ำร้อนอุณหภูมิสูง ก็จะเเสดงผลลัพธ์ที่ได้บนหน้าจอคอมพิวเตอร์ว่าขณะนี้อุณหภูมิมีค่าเท่าไหร่ เมื่ออุณหภูมิมากกว่าหรือเท่ากับ 30 องศา หลอดไฟ LED ก็จะติดสว่างขึ้น
เเต่เมื่อนำ sensors (DS18B20) ไปใส่ไว้ในน้ำเย็นอุณหภูมิต่ำ ก็จะเเสดงผลลัพธ์ที่ได้บนหน้าจอคอมพิวเตอร์ว่าขณะนี้อุณหภูมิมีค่าเท่าไหร่ เมื่ออุณหภูมิมีค่าน้อยกว่า 30 องศา หลอดไฟ LED ก็จะดับลงโดยอัติโนมัติ

## อภิปรายผลการทดลอง
จากการทดลอง เมื่ออัพโหลดโปรแกรมลงไปในไมโครคอนโทรเลอร์รันโปรแกรม และนำ sensors (DS18B20) ไปไว้ในที่ที่เราต้องการวัดอุณหภูมิ บนหน้าจอจะแสดงผล 
ค่าอุณหภูมิที่เวลานั้นๆ ในหน่วย Celsius เเละ Fahrenheit เมื่ออุณหภูมิมากกว่าหรือเท่ากับ 30 องศา หลอดไฟ LED ก็จะติดสว่างขึ้น เเละ เมื่ออุณหภูมิมีค่าน้อยกว่า 30 องศา 
หลอดไฟ LED ก็จะดับลงโดยอัติโนมัติ

## คำถามหลังการทดลอง
* **ถาม** เราสามารถตั้งค่าอุณหภูมิการติดดับของหลอดไฟ LED ได้หรือไม่
* **ตอบ** ได้ตามที่เราต้องการ เปลี่ยนในโค๊ดที่เราอัพโหลดว่าเราต้องการอุณหภูมิที่เท่าไหร่
































